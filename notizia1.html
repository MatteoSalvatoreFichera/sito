<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Parrocchia del Sacro Cuore di Gesù - Vittoria</title>
  <link rel="stylesheet" href="style.css" />
  <script>
    const pageId = 'eventi'; // Cambia questo in base alla pagina

    const editSelectors = [
      '.blocco-home h3',
      '.blocco-home p',
      '.evento-content h2',
      '.tabella-programma td',
    ];

    function loadModifiche() {
      const dati = JSON.parse(localStorage.getItem(`modifiche_${pageId}`) || '{}');
      for (const [selector, contenuto] of Object.entries(dati)) {
        const el = document.querySelector(selector);
        if (el) el.innerHTML = contenuto;
      }
    }

    function saveModifiche() {
      const datiSalvati = {};
      editSelectors.forEach(selector => {
        document.querySelectorAll(selector).forEach((el, i) => {
          const key = `${selector}:nth-of-type(${i + 1})`;
          datiSalvati[key] = el.innerHTML;
        });
      });
      localStorage.setItem(`modifiche_${pageId}`, JSON.stringify(datiSalvati));
      alert('Modifiche salvate!');
    }

    function attivaEditing() {
      if (sessionStorage.getItem('loggedIn') !== 'true') return;

      editSelectors.forEach(selector => {
        document.querySelectorAll(selector).forEach(el => {
          el.contentEditable = "true";
          el.style.border = "1px dashed #007BFF";
          el.style.padding = "4px";
          el.title = "Modifica questo contenuto";
        });
      });

      if (!document.getElementById('saveChangesBtn')) {
        const btn = document.createElement('button');
        btn.id = 'saveChangesBtn';
        btn.textContent = 'Salva modifiche';
        btn.style.display = 'block';
        btn.style.margin = '20px auto';
        btn.style.padding = '10px 20px';
        btn.style.fontSize = '1.1rem';
        document.querySelector('main').prepend(btn);
        btn.addEventListener('click', saveModifiche);
      }

      loadModifiche();
    }

    window.addEventListener('DOMContentLoaded', attivaEditing);
  </script>
</head>
<body>
  <div id="header"></div>

  <main>
    <!-- EVENTI -->
    <section class="blocco-home">
      <h3 style="text-align: center; margin-top: 50px;">FESTEGGIAMENTI DEL SACRO CUORE DI GESÙ - ANNO 2025</h3>

      <!-- PRIMA RIGA EVENTI -->
      <table>
        <tr>
          <td width="50%" align="left">
            <div class="blocco-home">
              <div class="evento-box">
                <img class="evento-img" src="epicoco.jpg" alt="Evento 1" />
                <div class="evento-content">
                  <h2>CATECHESI CON DON LUIGI MARIA EPICOCO</h2>
                  <p>GIOVEDÌ 19 GIUGNO 2025 ORE 20.00</p>
                </div>
              </div>
            </div>
          </td>
          <td width="50%" align="center">
            <div class="blocco-home">
              <div class="evento-box">
                <img class="evento-img" src="concerto.jpg" alt="Evento 2" />
                <div class="evento-content">
                  <h2>MANUELA VILLA - "CON ME" - TOUR 2025</h2>
                  <p>SABATO 28 GIUGNO ORE 21:00</p>
                </div>
              </div>
            </div>
          </td>
        </tr>
      </table>

      <!-- SECONDA RIGA EVENTI -->
      <table width="100%">
        <tr>
          <td width="33%" align="right">
            <div class="blocco-home">
              <div class="evento-box">
                <img class="evento-img" src="cavalli.jpg" alt="Evento 3" />
                <div class="evento-content">
                  <h2>SPETTACOLO EQUESTRE</h2>
                  <p>DOMENICA 29 GIUGNO 2025 ORE 10.00</p>
                </div>
              </div>
            </div>
          </td>
          <td width="33%" align="left">
            <div class="blocco-home">
              <div class="evento-box">
                <img class="evento-img" src="IMG_USCITA.jpg" alt="Evento 4" />
                <div class="evento-content">
                  <h2>SOLENNE USCITA</h2>
                  <p>DOMENICA 29 GIUGNO 2025 ORE 19.30</p>
                </div>
              </div>
            </div>
          </td>
          <td width="33%" align="center">
            <div class="blocco-home">
              <div class="evento-box">
                <img class="evento-img" src="SPETTACOLO.jpg" alt="Evento 5" />
                <div class="evento-content">
                  <h2>SPETTACOLO PIROMUSICALE</h2>
                  <p>DOMENICA 29 GIUGNO 2025 ORE 23.00</p>
                </div>
              </div>
            </div>
          </td>
        </tr>
      </table>

      <!-- PROGRAMMA -->
      <h2 style="text-align: center;">PROGRAMMA FESTEGGIAMENTI 18 GIUGNO - 13 LUGLIO</h2>
      <div class="contenitore">
        <table class="tabella-programma">
          <tr>
            <th class="orario">18 GIUGNO</th>
            <th class="orario">19 GIUGNO</th>
            <th class="orario">20 GIUGNO</th>
            <th class="orario">21 GIUGNO</th>
            <th class="orario">22 GIUGNO</th>
            <th class="orario">23 GIUGNO</th>
            <th class="orario">24 GIUGNO</th>
          </tr>
          <tr>
            <td><b>19:00</b><br>Messa<br><b>20:30</b><br>Gruppo giovani</td>
            <td><b>17:00</b><br>Azione Cattolica<br><b>19:00</b><br>Messa</td>
            <td><b>19:00</b><br>Messa<br><b>19:45</b><br>Cenacolo<br><b>20:30</b><br>Corso prematrimoniale</td>
            <td><b>19:00</b><br>Messa<br><b>20:30</b><br>Adorazione</td>
            <td><b>09:00</b><br>Messa<br>Adorazione<br><b>19:00</b><br>Messa</td>
            <td><b>19:00</b><br>Messa</td>
            <td><b>09:00</b><br>Messa<br><b>11:00</b><br>Messa<br><b>19:00</b><br>Messa</td>
          </tr>
          <tr>
            <th class="orario">25 GIUGNO</th>
            <th class="orario">26 GIUGNO</th>
            <th class="orario">27 GIUGNO</th>
            <th class="orario">28 GIUGNO</th>
            <th class="orario">29 GIUGNO</th>
            <th class="orario">13 LUGLIO</th>
          </tr>
          <tr>
            <td><b>19:00</b><br>Messa<br><b>20:30</b><br>Gruppo giovani</td>
            <td><b>17:00</b><br>Azione Cattolica<br><b>19:00</b><br>Messa</td>
            <td><b>19:00</b><br>Messa<br><b>19:45</b><br>Cenacolo<br><b>20:30</b><br>Corso prematrimoniale</td>
            <td><b>19:00</b><br>Messa<br><b>20:30</b><br>Adorazione</td>
            <td><b>09:00</b><br>Messa<br>Adorazione<br><b>19:00</b><br>Messa</td>
            <td><b>19:00</b><br>Messa</td>
          </tr>
        </table>
      </div>

      <!-- INFORMAZIONI -->
      <section id="info" style="padding: 20px; border-top: 1px solid #ccc; margin-top: 40px;">
        <h2>Informazioni</h2>
        <p id="info-content">
          Qui puoi inserire le informazioni importanti della parrocchia.
          Modifica questo testo usando il pulsante qui sotto.
        </p>
        <button id="edit-info-btn" style="margin-top: 10px;">Modifica Informazioni</button>
        <div id="edit-info-panel" style="display: none; margin-top: 10px;">
          <textarea id="info-textarea" style="width: 100%; height: 150px;"></textarea><br />
          <button id="save-info-btn">Salva</button>
          <button id="cancel-info-btn">Annulla</button>
        </div>
      </section>
    </section>
  </main>

  <div id="footer"></div>

  <script>
    fetch("header.html")
      .then(res => res.text())
      .then(data => document.getElementById("header").innerHTML = data);

    fetch("footer.html")
      .then(res => res.text())
      .then(data => document.getElementById("footer").innerHTML = data);
  </script>

  <script>
    const editBtn = document.getElementById("edit-info-btn");
    const editPanel = document.getElementById("edit-info-panel");
    const infoContent = document.getElementById("info-content");
    const textarea = document.getElementById("info-textarea");
    const saveBtn = document.getElementById("save-info-btn");
    const cancelBtn = document.getElementById("cancel-info-btn");

    editBtn.addEventListener("click", () => {
      textarea.value = infoContent.textContent.trim();
      editPanel.style.display = "block";
      editBtn.style.display = "none";
    });

    saveBtn.addEventListener("click", () => {
      const newText = textarea.value.trim();
      if (!newText) {
        alert("Il testo non può essere vuoto!");
        return;
      }
      infoContent.textContent = newText;
      localStorage.setItem("infoContent", newText);
      editPanel.style.display = "none";
      editBtn.style.display = "inline-block";
    });

    cancelBtn.addEventListener("click", () => {
      editPanel.style.display = "none";
      editBtn.style.display = "inline-block";
    });

    window.addEventListener("load", () => {
      const saved = localStorage.getItem("infoContent");
      if (saved) infoContent.textContent = saved;
    });
  </script>
</body>
</html>
